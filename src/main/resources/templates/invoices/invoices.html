<!DOCTYPE html>
<html lang="en" data-bs-theme="light"  xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="index">
<head>
<meta charset="UTF-8">
<title>Invoices's listt</title>
<link rel="stylesheet" type="text/css" href="css/invoices/invoiceslist.css">
</head>
<body>
    <div style="width: 95%;"	class="container d-flex flex-column gap-4  " 	layout:fragment="content">
    
    <!-- start hearder commun with all pages -->
    	<header class="container  p-1" >
    		
    		<a class=" rounded-1 bio-btn bio-btn-blue d-flex gap-1 align-items-center shadow" >
    				<i class="bi bi-plus-lg"></i> Add invoice
    		</a>
    	</header>
    	
     <!-- end hearder commun with all pages -->
    
    <!-- *******Error space -->
    <div>
		<div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert" th:inline="text">
			<strong>Input Error!</strong> [[${error}]]
			<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
		</div>
		
	</div>
    
    <!-- start content -->
    <section class="shadow-sm container mb-3 bg-white p-1 pb-4 rounded-1" >
	    	
	    	
	    	<div class="d-flex flex-column gap-4 ">
	    	
	    	
	    	<!-- table card start -->
				<form class="card border-0 " method="get" th:action="@{/invoicesPages}" id="search-form" >
					<div class="card-body ">
				
						<!-- table header -->
						<div class="bio-table-head ">
							<div class=" w-25 d-flex search-parent ">
				
								<i class="bi bi-search search-btn" id="search-btn"></i>
								<input type="search" name="mc" class="search search-input" placeholder="search" th:value="${mc}" id="search-input">
				
							</div>
							
							<select name="by" id="search-by" class="form-select" >
								<option th:selected="${by == 'username'? 'true': 'false'}" value="username">
									Username
								</option>
								<option  th:selected="${by == 'id'? 'true': 'false'}" value="id">
									Id
								</option>
							</select>
							
							<!-- input hidden for sort-->
							
							<input name="sort" th:value="${sort}" hidden id="sort">
							<!--  **************************** -->
				
				
							<div class="dropdown ms-auto">
								<a class=" text-secondary bio-btn bio-dropdown-toggle" data-bio-toggle="dropdown">
									<i class="bi bi-filter " style="font-size: 30px;"></i>
								</a>
								<ul class="bio-dropdown-menu dropdown-menu end-0">
									<li > <a th:class="dropdown-item + ${sort == 'id:ascending'? ' active': ''}" th:href="@{invoicesPages(mc=${mc}, size=${size}, sort='id:ascending' , by=${by})}"> <i class="bi bi-sort-up" ></i>Id</a> </li>
									<li > <a th:class="dropdown-item + ${sort == 'id:descending'? ' active': ''}" th:href="@{invoicesPages(mc=${mc}, size=${size}, sort='id:descending' , by=${by})}" ><i class="bi bi-sort-down" ></i>Id</a> </li>
									<li > <a th:class="dropdown-item + ${sort == 'dueToPay:ascending'? ' active': ''}" th:href="@{invoicesPages(mc=${mc}, size=${size}, sort='dueToPay:ascending' , by=${by})}"> <i class="bi bi-sort-up" ></i>Status</a> </li>
									<li > <a th:class="dropdown-item + ${sort == 'dueToPay:descending'? ' active': ''}" th:href="@{invoicesPages(mc=${mc}, size=${size}, sort='dueToPay:descending' , by=${by})}" ><i class="bi bi-sort-down" ></i>Status</a> </li>
								</ul>
							</div>
				
				
				
				
				
				
						</div>
						<!-- table header end -->
				
				
						<table class="table table-sm table-responsive table-hover align-middle">
							<thead>
								<tr>
									<th>Id</th>
									<th>Due date</th>
									<th>Bill from</th>
									<th>Bill to</th>
									<th>Status order</th>
									<th>#Order No</th>
									<th>Status invoice</th>
									<th>Total amount</th>
									<th>Vat</th>
									<th>Edit</th>
								</tr>
							</thead>
							<tbody class=" ">
								<tr th:each="invoice:${invoices}">
									<td th:text="${invoice.id}"> </td>
									<td><span th:class=" 'badge text-bg-' + ${ invoice.dueDate  <= now? 'danger':'success'}"
											th:text="${#dates.format(invoice.dueDate, 'dd-MM-yyyy')}"></span></td>
									<td>candice armane</td>
									<td th:text="${invoice.order.customer.username}"></td>
									<td><span th:class="'badge '+ ${mapStatusBG[invoice.order.status.name]}" th:text="${invoice.order.status}"></span></td>
									<td th:text="${invoice.order.id}"></td>
									<td> <span th:class="'badge text-bg-'+${invoice.dueToPay==0? 'success': 'danger'}"
											th:text="${invoice.dueToPay == 0?'Paid': 'Not paid'}"></span></td>
									<td th:text="${#numbers.formatDecimal(invoice.totalAmount,1,2)}"></td>
									<td th:text="${invoice.vat}">20</td>
									<td>
										<div class="d-flex gap-3">
											<a  ><i class="bi bi-x-lg text-danger"></i></a> 
											<a th:href="@{/invoice(id=${invoice.id} )}"><i class="bi bi-arrow-right text-secondary"></i></a>
										</div>
									</td>
								</tr>
								<tr class="text-center" th:if="${#lists.size(invoices) == 0}">
									<td colspan="10" class="no-elements">
										<div class="d-flex flex-column align-items-center">
											
											<h3> No available Invoice</h3>
											<a class="bio-btn text-secondary" th:href="@{/invoicesPages}">
												<i class="bi bi-box-arrow-left" style="font-size: var(--stat-icon-size);"></i>
											</a>
										</div>
									</td>
								</tr>
				
				
							</tbody>
				
							<tfoot>
				
				
							</tfoot>
						</table>
						<!-- section pagination -->
						<div class="section-nav d-flex gap-3 " th:if="${#lists.size(invoices) > 0}">
				
							<nav aria-label="Page navigation">
								<ul class="pagination pagination-sm">
									<li class="page-item"><a th:class="page-link+${page == 0? ' disabled':''} "
											th:href="@{invoicesPages(mc=${mc}, page= ${page -1 }, size = ${size}, sort=${sort}, by=${by}) }">Previous</a></li>
									<li th:each="value, status :${pages}" th:class="page-item+ ${page == status.index? ' active':'' }">
										<a class="page-link"
											th:href="@{invoicesPages(mc=${mc}, page= ${status.index }, size = ${size} , sort=${sort} , by=${by}) }"
											th:text="${status.index +1}"></a></li>
									<li class="page-item"><a th:class="page-link+ ${page+1 == totalPages? ' disabled':''}"
											th:href="@{invoicesPages(mc=${mc}, page= ${page +1 }, size = ${size}, sort=${sort} , by=${by}) }">Next</a></li>
								</ul>
							</nav>
							<div class="">
								<select class="form-select border-0  form-select-sm pageNumber" id="pageNumber" name="size" >
									<option th:attr="selected = ${size == 5}">5</option>
									<option th:attr="selected = ${size == 10}">10</option>
								</select>
				
							</div>
				
							<div th:if="${#lists.size(invoices) != 0}">
								<span class="text-secondary" th:inline="text">Total pages: [[${totalPages}]]</span>
							</div>
				
							<div th:if="${#lists.size(invoices) != 0}">
								<span class="text-secondary" th:inline="text">Total elemnts: [[${totalElements}]]</span>
							</div>
						</div>
				
				
				
					</div>
				</form>
	    	<!-- table card end -->
	    	
	    	</div>
	    	
	    	
	    </section>
    
     <script type="text/javascript" src="js/invoices/invoices.js"></script>
    </div>
    
</body>
</html>