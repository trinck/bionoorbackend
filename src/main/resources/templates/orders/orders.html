<!DOCTYPE html>
<html lang="en" data-bs-theme="light" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="index">

<head>
	<meta charset="UTF-8">
	<title>Orders's listt</title>
</head>

<body>
	<div style="width: 95%;" class="container d-flex flex-column gap-5" layout:fragment="content">

		<!-- start hearder commun with all pages -->
		<header class="row border-bottom p-1">
			<nav aria-label="breadcrumb">
				<ol class="breadcrumb">
					<li class="breadcrumb-item"><a href="#"> <i class="bi bi-house-fill"></i> </a></li>
					<li class="breadcrumb-item active" aria-current="page">Orders list</li>
				</ol>
			</nav>
		</header>

		<!-- end hearder commun with all pages -->
		<div>
			<div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert" th:inline="text">
				<strong>Input Error!</strong> [[${error}]]
				<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
			</div>

		</div>


		<!-- start content -->
		<section class=" container shadow-sm bg-white p-1 pb-5 mb-3 rounded-1">


			<div class="d-flex flex-column gap-4 ">


				<!-- table card start -->
				<form class="card border-0" method="get" th:action="@{/orders}" id="search-form">

					<div class="card-body">

						<!-- table header -->
						<div class="bio-table-head ">
							<div class=" w-25 d-flex search-parent ">

								<i class="bi bi-search search-btn" id="search-btn"></i>
								<input type="search" name="mc" class="search search-input" placeholder="search"
									th:value="${mc}" id="search-input">

							</div>

							<select name="by" id="search-by" class="form-select">
								<option th:selected="${by == 'customer'? 'true': 'false'}" value="customer">
									Customer
								</option>
								<option th:selected="${by == 'id'? 'true': 'false'}" value="id">
									Id
								</option>
								<option th:selected="${by == 'status'? 'true': 'false'}" value="status">
									Status
								</option>
							</select>

							<!-- input hidden for sort-->

							<input name="sort" th:value="${sort}" hidden id="sort">
							<!--  **************************** -->


							<div class="dropdown ms-auto">
								<a class=" text-secondary bio-btn bio-dropdown-toggle" data-bio-toggle="dropdown">
									<i class="bi bi-filter " style="font-size: 30px;"></i>
								</a>
								<ul class="bio-dropdown-menu dropdown-menu end-0">
									<li> <a th:class="dropdown-item + ${sort == 'id:ascending'? ' active': ''}"
											th:href="@{orders(mc=${mc}, size=${size}, sort='id:ascending' , by=${by})}">
											<i class="bi bi-sort-up"></i>Id</a> </li>
									<li> <a th:class="dropdown-item + ${sort == 'id:descending'? ' active': ''}"
											th:href="@{orders(mc=${mc}, size=${size}, sort='id:descending' , by=${by})}"><i
												class="bi bi-sort-down"></i>Id</a> </li>
									<li> <a th:class="dropdown-item + ${sort == 'totalAmount:ascending'? ' active': ''}"
											th:href="@{orders(mc=${mc}, size=${size}, sort='totalAmount:ascending' , by=${by})}">
											<i class="bi bi-sort-up"></i>Amount</a> </li>
									<li> <a th:class="dropdown-item + ${sort == 'totalAmount:descending'? ' active': ''}"
											th:href="@{orders(mc=${mc}, size=${size}, sort='totalAmount:descending' , by=${by})}"><i
												class="bi bi-sort-down"></i>Amount</a> </li>

								</ul>
							</div>


						</div>
						<!-- table header end -->


						<table class="table table-sm table-responsive table-hover align-middle">
							<thead>
								<tr>
									<th>#No</th>
									<th>customer</th>
									<th> Date</th>
									<th>total amount</th>
									<th>Items number</th>
									<th>Status</th>
									<th>Invoiced</th>
									<th>Method</th>
									<th>Edit</th>
								</tr>
							</thead>
							<tbody class="">
								<tr th:each="order:${orders}">
									<td th:text="${order.id}"></td>
									<td th:text="${order.customer.username}"></td>
									<td th:text="${#dates.format(order.createdAt, 'dd-MM-yyyy hh:mm:ss')}"> </td>
									<td th:text="${#numbers.formatDecimal(order.totalAmount,1,2)}"></td>
									<td th:text="${#lists.size(order.orderItems)}"></td>
									<td><span th:class="'badge '+${mapStatusBG[order.status.name]}"
											th:text="${order.status}"> </span></td>
									<td><i
											th:class=" ${order.invoice!=null? 'bi bi-check-circle text-success': 'bi bi-check-circle text-danger'}"></i>
									</td>
									<td th:text="${order.paymentMethod!=null ?order.paymentMethod.name:'N/A' }"></td>
									<td>
										<div class="d-flex gap-3"><a href="#"><i
													class="bi bi-check-lg text-success"></i></a> <a href="#"><i
													class="bi bi-x-lg text-danger"></i> </a> <a
												th:href="@{/orederView(id = ${order.id})}"><i
													class="bi bi-arrow-right text-secondary"></i></a></div>
									</td>
								</tr>
								<tr class="text-center" th:if="${#lists.size(orders) == 0}">
									<td colspan="10" class="no-elements">
										<div class="d-flex flex-column align-items-center">

											<h3> No Available Product</h3>
											<a class="bio-btn text-secondary" th:href="@{/orders}">
												<i class="bi bi-box-arrow-left"
													style="font-size: var(--stat-icon-size);"></i>
											</a>
										</div>
									</td>
								</tr>





							</tbody>

							<tfoot>


							</tfoot>
						</table>
						<!-- navigation -->
						<div class="section-nav d-flex gap-3 " th:if="${#lists.size(orders) > 0}">

							<nav aria-label="Page navigation">
								<ul class="pagination pagination-sm">
									<li class="page-item"><a th:class="page-link+${page == 0? ' disabled':''} "
											th:href="@{orders(mc=${mc}, page= ${page -1 }, size = ${size}, sort=${sort}, by=${by}) }">Previous</a>
									</li>
									<li th:each="value, status :${pages}"
										th:class="page-item+ ${page == status.index? ' active':'' }">
										<a class="page-link"
											th:href="@{orders(mc=${mc}, page= ${status.index }, size = ${size} , sort=${sort} , by=${by}) }"
											th:text="${status.index +1}"></a>
									</li>
									<li class="page-item"><a
											th:class="page-link+ ${page+1 == totalPages? ' disabled':''}"
											th:href="@{orders(mc=${mc}, page= ${page +1 }, size = ${size}, sort=${sort} , by=${by}) }">Next</a>
									</li>
								</ul>
							</nav>
							<div class="" th:if="${totalElements > 5}">
								<select class="form-select border-0  form-select-sm pageNumber" id="pageNumber"
									name="size">
									<option th:attr="selected = ${size == 5}">5</option>
									<option th:attr="selected = ${size == 10}">10</option>
								</select>

							</div>

							<div th:if="${#lists.size(orders) != 0}">
								<span class="text-secondary" th:inline="text">Total pages: [[${totalPages}]]</span>
							</div>

							<div th:if="${#lists.size(orders) != 0}">
								<span class="text-secondary" th:inline="text">Total elemnts: [[${totalElements}]]</span>
							</div>
						</div>

					</div>



				</form>

				<!-- table card end -->

			</div>


		</section>

	</div>

</body>

</html>